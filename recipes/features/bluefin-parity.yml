# yaml-language-server: $schema=https://schema.blue-build.org/module-stage-list-v1.json
modules:
# Install the important GNOME Extensions 
- type: gnome-extensions
  install:
  - AppIndicator and KStatusNotifierItem Support
  - Dash to Dock
  - Blur my Shell 
  - Logo Menu 

# Install packages that Bluefin comes with (or we add to bluefin)
- type: dnf
  repos:
    copr:
      - ublue-os/staging
      - ublue-os/packages
  install:
    install-weak-deps: false
    packages:
      - desktop-backgrounds-waves
      - rclone
      - restic
      - gnome-disk-utility
      - wl-clipboard
      - nss-mdns
      - powertop
      - fzf
      - ffmpegthumbnailer
      - papers-thumbnailer 
      - openssh-askpass
      - waypipe
      - firewall-config
      - setools-console
      - lm_sensors
      - clinfo
      - uupd
      - glow

# Needed because ublue-motd runs on our non-ublue images
- from-file: features/minimal-ublue-motd.yml

# VSCode gets installed by itself to work around EL10 crypto issues
- from-file: features/vscode.yml      
  
# Bluefin moved all of their custom packages to an OCI container 
# We copy the "shared" part of Bluefin's common stuff, since
# it's shared by all the ublue-adjacent stuff
- type: copy
  from: ghcr.io/projectbluefin/common:latest
  src: /system_files/shared 
  dest: /

# Copy stuff needed to complete the ujust setup
- type: files
  files:
    - source: just
      destination: /

# Use uupd for updates
- type: systemd
  system:
    enabled:
      - uupd.timer
    disabled:
      - rpm-ostreed-automatic.timer
      - flatpak-system-update.timer
      - bootc-fetch-apply-updates.timer

# Bluefin moved their artwork to an OCI container
- type: copy
  from: ghcr.io/ublue-os/bluefin-wallpapers-gnome:latest
  src: /
  dest: /usr/share/backgrounds/bluefin

# Install Brew
- type: copy
  from: ghcr.io/ublue-os/brew:latest
  src: /system_files
  dest: /
- type: systemd
  system:
    enabled:
      - brew-setup